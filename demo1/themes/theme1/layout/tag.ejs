<div class="tags-page">
    <%- partial('components/taglist',{cache: true}) %>
</div>
<div class="tags-page-list">
    <% site.tags.sort('name').each(function(tag){ %>
        <div class="tag-group" id="tag-<%= tag.name.toLowerCase() %>">
            <h3 class="tag-name">
                <%= tag.name %>
                <small>(<%= tag.posts.length %>)</small>
            </h3>
            <ul class="tag-post-list">
                <% tag.posts.sort('date', -1).each(function(post){ %>
                    <li>
                        <a href="<%- url_for(post.path) %>">
                            <%= post.title %>
                        </a>
                        <span class="post-date">
                            <%= date(post.date, 'YYYY-MM-DD') %>
                        </span>
                    </li>
                <% }) %>
            </ul>
        </div>
    <% }) %>
</div>
<script>
    // 页面加载完成后执行
    document.addEventListener('DOMContentLoaded', function() {
        // 获取URL中的标签名
        const tagName = window.location.pathname.split('/tag/')[1];
        if (tagName) {
            // 移除可能的结尾斜杠并转为小写
            const cleanTagName = decodeURIComponent(tagName).replace(/\/$/, '').toLowerCase();
            const targetElement = document.getElementById('tag-' + cleanTagName);
            if (targetElement) {
                // 等待一小段时间确保页面完全加载
                setTimeout(() => {
                    // 获取目标元素的位置
                    const targetPosition = targetElement.offsetTop;
                    // 获取header高度（如果有固定header的话）
                    const headerHeight = document.querySelector('header')?.offsetHeight || 0;
                    // 平滑滚动到目标位置，并留出header的高度
                    console.log(targetPosition);
                    document.querySelector('.main').scrollTo({
                        top: targetPosition - headerHeight,
                        behavior: 'smooth'
                    });
                    
                }, 100);
            }
        }
    });
</script>